{"ast":null,"code":"// client/src/services/socketService.ts\nimport { io } from \"socket.io-client\";\n\n// 👇 store the instance globally to persist across hot reloads\nconst globalSocket = window._globalSocket || null;\nclass SocketService {\n  constructor() {\n    this.socket = globalSocket;\n    this.hasConnected = !!globalSocket;\n  }\n  connect() {\n    var _this$socket;\n    if (this.hasConnected && (_this$socket = this.socket) !== null && _this$socket !== void 0 && _this$socket.connected) {\n      console.log(\"⚙️ Already connected:\", this.socket.id);\n      return;\n    }\n    if (!this.socket) {\n      this.socket = io(\"http://localhost:3001\", {\n        transports: [\"websocket\"],\n        reconnection: true\n      });\n      window._globalSocket = this.socket; // 👈 persist globally\n    }\n    this.hasConnected = true;\n    this.socket.on(\"connect\", () => {\n      var _this$socket2;\n      console.log(\"✅ Connected to server with ID:\", (_this$socket2 = this.socket) === null || _this$socket2 === void 0 ? void 0 : _this$socket2.id);\n    });\n    this.socket.on(\"disconnect\", reason => {\n      console.log(\"❌ Disconnected:\", reason);\n    });\n    this.socket.on(\"connect_error\", err => {\n      console.error(\"⚠️ Connection error:\", err.message);\n    });\n  }\n  on(event, callback) {\n    var _this$socket3;\n    (_this$socket3 = this.socket) === null || _this$socket3 === void 0 ? void 0 : _this$socket3.on(event, callback);\n  }\n  off(event, callback) {\n    if (!this.socket) return;\n    if (callback) this.socket.off(event, callback);else this.socket.off(event);\n  }\n  emit(event, data) {\n    var _this$socket4;\n    (_this$socket4 = this.socket) === null || _this$socket4 === void 0 ? void 0 : _this$socket4.emit(event, data);\n  }\n  disconnect() {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n      window._globalSocket = null;\n      this.hasConnected = false;\n    }\n  }\n  isConnected() {\n    return !!(this.socket && this.socket.connected);\n  }\n}\nexport const socketService = new SocketService();","map":{"version":3,"names":["io","globalSocket","window","_globalSocket","SocketService","constructor","socket","hasConnected","connect","_this$socket","connected","console","log","id","transports","reconnection","on","_this$socket2","reason","err","error","message","event","callback","_this$socket3","off","emit","data","_this$socket4","disconnect","isConnected","socketService"],"sources":["/Users/rishabhmishra/Desktop/multiplayer-grid-app/client/src/services/socketService.tsx"],"sourcesContent":["// client/src/services/socketService.ts\nimport { io, Socket } from \"socket.io-client\";\n\n// 👇 store the instance globally to persist across hot reloads\nconst globalSocket = (window as any)._globalSocket || null;\n\nclass SocketService {\n  private socket: Socket | null = globalSocket;\n  private hasConnected = !!globalSocket;\n\n  connect(): void {\n    if (this.hasConnected && this.socket?.connected) {\n      console.log(\"⚙️ Already connected:\", this.socket.id);\n      return;\n    }\n\n    if (!this.socket) {\n      this.socket = io(\"http://localhost:3001\", {\n        transports: [\"websocket\"],\n        reconnection: true,\n      });\n      (window as any)._globalSocket = this.socket; // 👈 persist globally\n    }\n\n    this.hasConnected = true;\n\n    this.socket.on(\"connect\", () => {\n      console.log(\"✅ Connected to server with ID:\", this.socket?.id);\n    });\n\n    this.socket.on(\"disconnect\", (reason) => {\n      console.log(\"❌ Disconnected:\", reason);\n    });\n\n    this.socket.on(\"connect_error\", (err) => {\n      console.error(\"⚠️ Connection error:\", err.message);\n    });\n  }\n\n  on(event: string, callback: (...args: any[]) => void): void {\n    this.socket?.on(event, callback);\n  }\n\n  off(event: string, callback?: (...args: any[]) => void): void {\n    if (!this.socket) return;\n    if (callback) this.socket.off(event, callback);\n    else this.socket.off(event);\n  }\n\n  emit(event: string, data?: any): void {\n    this.socket?.emit(event, data);\n  }\n\n  disconnect(): void {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n      (window as any)._globalSocket = null;\n      this.hasConnected = false;\n    }\n  }\n\n  isConnected(): boolean {\n    return !!(this.socket && this.socket.connected);\n  }\n}\n\nexport const socketService = new SocketService();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}